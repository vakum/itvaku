;TEST PROGRAM FOR ALS-NIFC-01 WITH ALS-PCI-CARD

;MASM PROGRAM FOR STEPPER MOTOR - ANTICLOCKWISE 

CONTROL         EQU     0E883H
MODE            EQU     080H
PORTA           EQU     0E880H
PORTB           EQU     0E881H
PORTC           EQU     0E882H

PHASE_A         EQU     0EEH
PHASE_B         EQU     0DDH
PHASE_C         EQU     0BBH
PHASE_D         EQU     077H

CSEG	SEGMENT
	ASSUME CS:CSEG
START:
	MOV	DX,CONTROL
	MOV	AL,MODE
	OUT	DX,AL
	
UP:	
	MOV	AL,PHASE_A
	MOV	DX,PORTC
	OUT	DX,AL
	CALL	DLY
	
	MOV	AL,PHASE_B
	MOV	DX,PORTC
	OUT	DX,AL
	CALL	DLY
	
	MOV	AL,PHASE_C
	MOV	DX,PORTC
	OUT	DX,AL
	CALL	DLY
	
	MOV	AL,PHASE_D
	MOV	DX,PORTC
	OUT	DX,AL
	CALL	DLY
		
	MOV	AH,0BH
	INT	21H
	OR	AL,AL
	
	JZ	UP

	MOV	AH,4CH
	INT	21H

DLY	PROC	NEAR
        MOV     CX,7FFH          ;change cx for variable delay
ABVE:	PUSH	CX
	CALL	HELP
	POP	CX
	LOOP	ABVE
	
	RET
DLY	ENDP

HELP	PROC	NEAR
        MOV     CX,09999H
DLY1:	LOOP	DLY1
	RET
HELP	ENDP		

CSEG	ENDS

	END
		
